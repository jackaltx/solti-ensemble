# ISPConfig Backup Manifest

**Backup Date:** {{ backup_timestamp }}  
**Generated by:** Ansible ISPConfig Backup Role  
**Repository:** {{ ispconfig_backup_git.repository_path }}

## Backup Targets

| Target Name | Source Path | Type | Status |
|-------------|-------------|------|---------|
{% for target in backup_targets_processed %}
{% if target.condition | default(true) | bool %}
| {{ target.name }} | {{ target.path }} | {{ target.type }} | ✅ Backed up |
{% endif %}
{% endfor %}

## Repository Structure

```
{{ ispconfig_backup_git.repository_path }}/
├── configs/                    # Actual configuration files
{% for target in backup_targets_processed %}
{% if target.condition | default(true) | bool %}
│   ├── {{ target.name }}/             # {{ target.path }}
{% endif %}
{% endfor %}
├── fingerprints/              # SHA256 checksums for change detection
{% for target in backup_targets_processed %}
{% if target.condition | default(true) | bool %}
│   ├── {{ target.name }}.fingerprints
{% endif %}
{% endfor %}
├── BACKUP_MANIFEST.md         # This file
└── LAST_AUDIT_REPORT.md      # Latest audit results
```

## Usage

### Run Backup
```yaml
- include_role:
    name: jackaltx.solti_ensemble.ispconfig_backup
```

### Run Audit
```yaml
- include_role:
    name: jackaltx.solti_ensemble.ispconfig_backup
    tasks_from: audit.yml
```

### Run Audit with Differences
```yaml
- include_role:
    name: jackaltx.solti_ensemble.ispconfig_backup
    tasks_from: audit.yml
    vars:
      ispconfig_audit_show_differences: true
```

### View Changes
```bash
cd {{ ispconfig_backup_git.repository_path }}
git log --oneline
git show <commit-hash>
```

## Excluded Patterns

The following patterns are excluded from backups:
{% for target in backup_targets_processed %}
{% if target.exclude_patterns is defined %}
- **{{ target.name }}:** {{ target.exclude_patterns | join(', ') }}
{% endif %}
{% endfor %}

---
*Generated automatically by ISPConfig Backup Role*